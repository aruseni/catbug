/*! catbug.js 0.0.0
 *  2013-05-19 02:00:43 +0400
 *  https://github.com/pozadi/catbug.js
 */
window.catbug=function(){return catbug.core.module.apply(catbug,arguments)},catbug.ns=function(e,t){var n,r,i,o,l;for(n=this,l=e.split("."),i=0,o=l.length;o>i;i++)r=l[i],r&&(n=n[r]||(n[r]={}));return t(n,this)},catbug.ns("treeParser",function(e){return e.attrDelimiter=/\s+/,e.sideQuotes=/^["']|["']$/g,e.nonEmpty=/\S+/,e.indentation=/^\s+/,e.selectorAndAttrs=/^([^\(\)]+)(?:\(([^\(\)]+)\))?$/,e.parseToRaw=function(t){var n,r,i,o,l;return o=function(t){return e.nonEmpty.test(t)},n=function(t){var n;return{level:(null!=(n=e.indentation.exec(t))?n[0].length:void 0)||0,data:$.trim(t)}},l=function(e,t){var n,r,i,o,l;for(null==t&&(t="level"),n=_.min(_.pluck(e,"level")),l=[],i=0,o=e.length;o>i;i++)r=e[i],l.push(r[t]=r.level-n);return l},r=function(e,t){var n,i,o,a,u,s,c;for(l(e,"normLevel"),u=[],i=null,n=function(){var e;return i?(e={data:i.data,level:i.level,parent:t},e.children=r(a,e),u.push(e)):void 0},s=0,c=e.length;c>s;s++)if(o=e[s],o.normLevel>0){if(!i)throw Error("unexpected indent");a.push(o)}else n(),i=o,a=[];return n(),u},i=_.chain(t.split("\n")).filter(o).map(n).value(),l(i),r(i,null)},e.flat=function(e){var t,n;return n=[],t=function(e){var r,i,o,l;for(l=[],i=0,o=e.length;o>i;i++)r=e[i],n.push(r),l.push(t(r.children));return l},t(e),n},e.parseAttributes=function(t){var n,r,i,o,l,a,u,s;if(i={},t)for(u=t.split(e.attrDelimiter),l=0,a=u.length;a>l;l++)n=u[l],s=n.split("="),r=s[0],o=s[1],i[r]=null!=o?o.replace(e.sideQuotes,""):void 0;return i},e.parseLine=function(t){var n;if(n=e.selectorAndAttrs.exec(t),!n)throw Error("wrong syntax");return{selector:$.trim(n[1]),attributes:e.parseAttributes(n[2])}},e.selectorToName=function(e){return $.camelCase(e.replace(/[^a-z0-9]+/gi,"-").replace(/^-/,"").replace(/-$/,"").replace(/^js-/,""))},e.genName=function(t){return t.name=t.attributes.name?t.attributes.name:e.selectorToName(t.selector)},e.parse=function(t){var n,r,i,o,l,a;if(i=e.parseToRaw(t),1!==i.length)throw Error("more than one root");for(r=e.flat(i),o=0,l=r.length;l>o;o++)n=r[o],_.extend(n,e.parseLine(n.data)),n.selector=n.selector.replace("&",null!=(a=n.parent)?a.selector:void 0);return r=_.map(r,function(e){return _.pick(e,"selector","attributes","level")}),_.each(r,e.genName),{root:_.findWhere(r,{level:0}),elements:_.filter(r,function(e){return e.level>0})}}}),catbug.ns("core",function(e){return jQuery.prototype.catbug=function(t){var n;return n=this.get(0),n?e.instances[t].init(n):void 0}});var __bind=function(e,t){return function(){return e.apply(t,arguments)}};catbug.ns("core",function(e,t){return e.instances={},e.Module=function(){function e(e,t,n,r){this.name=e,this.rootSelector=t,this.elements=n,this.builder=r,this.initAll=__bind(this.initAll,this)}return e.prototype.jqueries=function(e){var t,n,r,i,o;for(n={},o=this.elements,r=0,i=o.length;i>r;r++)t=o[r],n[t.name]=$(t.selector,e);return n},e.prototype.builderContext=function(e){var t,n,r,i,o;for(n={},o=["find","on","off","data","addClass","removeClass","toggleClass","hide","show","toggle"],r=0,i=o.length;i>r;r++)t=o[r],n[t]=_.bind(e[t],e);return _.extend(n,{root:e},this.jqueries(e))},e.prototype.init=function(e){var t;return e=$(e),t="catbug-"+this.name,e.data(t)||e.data(t,this.builder.call(this.builderContext(e))),e.data(t)},e.prototype.initAll=function(){var e,t,n,r,i;for(r=$(this.rootSelector),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(this.init(e));return i},e}(),e.module=function(n,r,i){var o;return null==i&&(i=r,r=_.uniqueId("lambda-")),n=t.treeParser.parse(n),e.instances[r]=o=new e.Module(r,n.root.selector,n.elements,i),$(o.initAll)}});